# Final output location for packaged datasets
final_output_folder: "./generated_datasets"

# ---------------------------------------------------------------------
# DEFAULTS (used unless overridden in each section)
# ---------------------------------------------------------------------
defaults:
  seed: 42

  dates:
    start: "2021-01-02"
    end: "2026-12-31"

  paths:
    geography: "./data/parquet_dims/geography.parquet"

# ---------------------------------------------------------------------
# SALES FACT GENERATION
# ---------------------------------------------------------------------
sales:
  parquet_folder: "./data/parquet_dims"
  out_folder: "./data/fact_out"

  total_rows: 200230
  chunk_size: 1000000

  file_format: "deltaparquet"          # csv | parquet | deltaparquet
  write_delta: true
  delta_output_folder: "./data/fact_out/delta"

  merge_parquet: true
  merged_file: "sales.parquet"
  delete_chunks: true

  row_group_size: 2000000
  compression: "snappy"

  heavy_pct: 5
  heavy_mult: 5

  workers: 8               # auto-detect if null
  write_pyarrow: true
  tune_chunk: false

  skip_order_cols: true

  override:
    dates:
      end: null
    seed: null

  partitioning:
    enabled: true
    columns: ["Year", "Month"]

# ---------------------------------------------------------------------
# PRODUCTS
# ---------------------------------------------------------------------
products:
  use_contoso_products: false
  num_products: 6022
  active_ratio: 0.94
  seed: 42

  pricing:
    base:
      value_scale: 0.10
      min_unit_price: 10
      max_unit_price: 5000

      # optional tuning:
      stretch_to_range: false
      stretch_low_quantile: 0.01
      stretch_high_quantile: 0.99

    cost:
      mode: margin          # add this (or "keep" if you want to preserve Contoso UnitCost when use_contoso_products: true)
      min_margin_pct: 0.20
      max_margin_pct: 0.45

    jitter:
      price_pct: 0.03
      cost_pct: 0.02

    # NEW: controls how prices *look* (works for max 2000 / 10000 / etc.)
    appearance:
      snap_unit_price: true
      price_ending: 0.99
      price_bands:
        - {max: 100,   step: 1}
        - {max: 1000,  step: 10}
        - {max: 10000, step: 50}
        - {max: 1e18,  step: 100}

      round_unit_cost: true
      cost_bands:
        - {max: 100,   step: 0.05}
        - {max: 1000,  step: 0.10}
        - {max: 10000, step: 1}
        - {max: 1e18,  step: 5}

# ---------------------------------------------------------------------
# CUSTOMERS
# ---------------------------------------------------------------------
customers:
  total_customers: 18413
  active_ratio: 0.90

  pct_india: 10
  pct_us: 51
  pct_eu: 39
  pct_org: 10

  names_folder: "./data/customer_names"

  lifecycle:
    enable_churn: true
    base_monthly_churn: 0.52
    min_tenure_months: 22
    initial_active_customers: 2000        # or 1000
    initial_spread_months: 36            # customers started in the 24 months before start_date

  override:
    seed: null
    paths: {}
    dates: {}

# ---------------------------------------------------------------------
# GEOGRAPHY / LOCATIONS
# ---------------------------------------------------------------------
geography:
  target_rows: 200

  country_weights:
    United States: 0.35
    India: 0.20
    United Kingdom: 0.10
    Germany: 0.10
    France: 0.10
    Australia: 0.07
    Canada: 0.08
    China: 0.00
    Japan: 0.00
    South Africa: 0.00
    Rest: 0.00

  override:
    dates: {}
    paths: {}
    seed: null


# ---------------------------------------------------------------------
# PROMOTIONS
# ---------------------------------------------------------------------
promotions:
  num_seasonal: 21
  num_clearance: 8
  num_limited: 12

  override:
    dates:
      start: null      # null means: use defaults
      end: null
    seed: null


# ---------------------------------------------------------------------
# STORES / RETAIL OUTLETS
# ---------------------------------------------------------------------
stores:
  num_stores: 50

  opening:
    start: "1995-01-01"
    end: "2020-12-31"

  closing_end: "2025-12-31"

  override:
    seed: null
    paths: {}


# ---------------------------------------------------------------------
# DATES (Dimension)
# ---------------------------------------------------------------------
dates:
  fiscal_month_offset: 5
  as_of_date: "2026-12-31"  # anchor for IsToday/IsCurrent* and CurrentDayOffset
                            # Treat end of dataset as “today” (default): omit it (it uses raw_end). 
                            # Anchor to last year end: as_of_date: "2025-12-31"
  include:
    calendar: true        # always true (safe default)
    iso: false            # ISO week columns
    fiscal: false         # fiscal year / quarter / month columns

  override:
    dates:
      start: null     # optional, null = use defaults
      end:   null     # optional, null = use defaults


# ---------------------------------------------------------------------
# EXCHANGE RATES
# ---------------------------------------------------------------------
exchange_rates:
  use_global_dates: true

  # Master FX history storage
  master_file: "./data/exchange_rates_master/fx_master.parquet"

  currencies: ["USD", "EUR", "INR", "GBP", "AUD", "CAD"]
  base_currency: "USD"
  volatility: 0.02

# Used only when use_global_dates = false
  override:
    dates:
      start: "2009-01-01"
      end: "2025-11-18"        # optional (ignored if use_global_dates=true)
    seed: null
